# OrigionExcel2DataBase 使用说明

## 程序功能介绍

此程序用于将交叉表格式的汽车吊（起重机）数据转换为数据库友好的行格式。

### 主要功能

1. **数据格式转换**：
   - 将交叉表格式（第一行为主臂长，第一列为幅度，交叉单元格为额定吊重）转换为标准数据库格式
   - 生成六列数据：汽车吊型号、工况编号、工况名称、汽车吊幅度、汽车吊主臂长、汽车吊额定吊重

2. **文件名解析**：
   - 从文件名中提取汽车吊型号（第一个括号内容）
   - 提取工况编号（文件名开头的数字）
   - 提取工况名称（第二个括号内容）

3. **批量处理**：
   - 支持同时处理多个汽车吊Excel文件
   - 将多文件数据合并为一个输出文件

4. **数据排序**：
   - 按照特定顺序排序：汽车吊型号 → 工况编号 → 工况名称 → 主臂长 → 幅度 → 额定吊重

5. **错误处理**：
   - 强大的异常处理机制，即使部分文件处理失败也能继续处理其他文件
   - 详细的错误和警告信息

## 使用方法

### 1. 启动程序

- 直接运行Python脚本 `OrigionExcel2DataBase.py`

### 2. 选择文件

- 程序启动后会打开文件选择对话框
- 可以选择一个或多个Excel文件（可以按住Ctrl键多选）
- 文件名格式要求：`工况编号-(汽车吊型号)-(工况名称).xlsx`
- 例如：`1-(STC250E-1)-(配重6.2t，支腿全伸).xlsx`

### 3. 文件处理

- 程序会自动处理选定的文件
- 控制台会显示处理进度和任何警告或错误信息
- 处理过程中会进行数据验证和清理

### 4. 结果输出

- 处理完成后，程序会在输入文件的同一目录下生成结果文件
- 输出文件命名格式：`汽车吊名称-额定起重量表-时间戳.xlsx`
- 如处理多种汽车吊，则命名为：`多种汽车吊-额定起重量表-时间戳.xlsx`

### 5. 完成后操作

- 处理完成后会显示处理统计信息
- 提供继续处理更多文件或退出程序的选项

## 输入格式要求

### 文件命名

输入Excel文件需命名为：`工况编号-(汽车吊型号)-(工况名称).xlsx`
例如：`1-(STC250E-1)-(配重6.2t，支腿全伸).xlsx`

### 表格内容

输入Excel文件需满足以下格式：
- 第一行（除第一格）包含主臂长度值
- 第一列（除第一格）包含幅度值
- 表格主体单元格包含对应的额定吊重值

示例表格格式：

| | 10m | 20m | 30m | 40m |
|---|---|---|---|---|
| 3m | 50t | 40t | 30t | 20t |
| 6m | 45t | 35t | 25t | 15t |
| 9m | 40t | 30t | 20t | 10t |
| 12m | 35t | 25t | 15t | 5t |

## 输出格式

输出Excel文件包含以下列：
- **TruckCraneID**：汽车吊型号
- **ConditionID**：工况编号
- **SpeWorkCondition**：工况名称
- **TruckCraneRange**：汽车吊幅度(m)
- **TruckCraneMainArmLen**：汽车吊主臂长(m)
- **TruckCraneRatedLiftingCap**：汽车吊额定吊重(t)

## 注意事项

1. 确保Excel文件中的数据单元格包含有效的数值
2. 程序会自动跳过空值和非数值内容
3. 负值和零值将被视为"不可吊装"而被忽略
4. 建议先处理少量文件测试，确认格式正确后再批量处理

## 常见问题

### Q: 为什么我的文件无法被处理？
A: 请检查文件名格式是否符合要求，以及表格内容是否按照要求的格式排列。

### Q: 为什么有些数据在输出中消失了？
A: 程序会跳过空值、非数值、零值和负值。这些通常表示在该条件下不可吊装。

### Q: 如何同时处理多个文件？
A: 在文件选择对话框中按住Ctrl键选择多个文件。

### Q: 输出文件保存在哪里？
A: 输出文件保存在您处理的第一个输入文件所在的同一目录下。